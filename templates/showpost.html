{% extends 'base.html' %}
{% block content %}

<p>Post Page by ID</p>

<p> 
        
    <span>
    {% if post.user.profile_picture %}
        <img src="{{ url_for('static', filename='profile_pictures/' + post.user.profile_picture) }}" alt="Profile Picture">
    {% else %}
     <img src="{{ url_for('static', filename='images/blank-profile-pic.png') }}" alt="Profile Picture">
    {% endif %}
    </span>
    <strong> {{ post.user.username }}</strong>
</p>

<br>

<p>{{ post.body }}</p>
 <p style="font-weight:lighter">
     • 
    {{ post.created_at.strftime('%B %Y') }} 
    <br>
</p>


{% if logged_in %}

        <!-- Like ♥ -->
        <p>
            <a href="#" class="like-button" data-post-id="{{ post.id }}" {% if current_user and post in current_user.liked_posts %}class="liked"{% endif %} onclick="likePost(event, this); return false;">
                <span class="likes-wrapper">
                {% if post.likes == 1 %}
                    <span class="heart-emoji red-heart">♥</span>
                {% else %}
                    <span class="heart-emoji empty-heart">♥</span>
                {% endif %}
                <span class="likes-count">{{ post.likes }}</span>
                </span>
            </a>
            </p> 
            <!-- End of Like ♥ -->

<hr>

 <!-- Comment Section  -->
<form action="{{url_for('show_post', post_id=post.id)}}" method="post">
{{ form.csrf_token }}
{{ form.comment }}
{{ form.submit }}
</form>
{% endif %}


 <!-- Display existing comments -->
 <h3>Comments</h3>
 {% for comment in post.comments %}
 <span>
    {% if comment.user.profile_picture %}
        <img class="comment-img" src="{{ url_for('static', filename='profile_pictures/' + comment.user.profile_picture) }}" alt="Profile Picture">
    {% else %}
     <img src="{{ url_for('static', filename='images/blank-profile-pic.png') }}" alt="Profile Picture">
    {% endif %}
    {{comment.user.username }}
    </span>
    
     <p>{{ comment.content }}</p>
     <br> <hr>
     
     <!-- Display other comment information -->
 {% endfor %}



{% endblock %}



<!-- 
<script>
    function likePost(postId) {
      fetch(`/post/${postId}/like`, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'X-CSRFToken': '{{ csrf_token() }}'  // Assuming you're using CSRF protection
        },
      })
      .then(response => {
        if (response.ok) {
          // Handle successful response, e.g., display a success message
          console.log('Post liked successfully');
        } else {
          // Handle error response, e.g., display an error message
          console.error('Failed to like the post');
        }
      })
      .catch(error => {
        // Handle error, e.g., display an error message
        console.error('An error occurred:', error);
      });
    }
  </script> -->